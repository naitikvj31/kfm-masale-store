generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Product {
  id          Int            @id @default(autoincrement())
  name        String
  description String?
  imageUrl    String?
  isActive    Boolean        @default(true)
  sortOrder   Int            @default(0)
  variants    Variant[]
  images      ProductImage[]
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
}

model ProductImage {
  id        Int     @id @default(autoincrement())
  productId Int
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  url       String
  sortOrder Int     @default(0)
}
model Variant {
  id            Int         @id @default(autoincrement())
  productId     Int
  product       Product     @relation(fields: [productId], references: [id], onDelete: Cascade)
  size          String      // e.g., "50g", "100g", "1kg"
  price         Float
  discountPrice Float?      // New field: the discounted selling price (if null, no discount)
  stockQuantity Int         @default(0)
  orderItems    OrderItem[]
}

model Order {
  id              Int         @id @default(autoincrement())
  customerName    String
  customerEmail   String?
  customerPhone   String
  customerAddress String
  totalAmount     Float
  status          String      @default("Pending") // Pending, Processing, Shipped, Delivered, Cancelled
  orderItems      OrderItem[]
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  orderId   Int
  order     Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  variantId Int
  variant   Variant @relation(fields: [variantId], references: [id])
  quantity  Int     @default(1)
  price     Float   // Price per unit at time of purchase
}
